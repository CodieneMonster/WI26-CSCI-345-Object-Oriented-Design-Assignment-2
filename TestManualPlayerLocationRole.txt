public class TestManualPlayerLocationRole {

    private static int testsRun = 0;
    private static int testsPassed = 0;

    public static void main(String[] args) {
        System.out.println("=== MANUAL TESTS: Player, Location, Role ===\n");

        testAdjacency();
        testIllegalMove();
        testMoveWhileWorking();
        testTakeRoleRankCheck();
        testRoleOccupancy();
        testRehearse();
        testDropRole();
        testStatusString();

        System.out.println("\n=== TEST SUMMARY ===");
        System.out.println("Passed " + testsPassed + " / " + testsRun + " tests.");
    }

    // -------------------- Helper --------------------
    private static void check2(boolean condition, String testName) {
        testsRun++;
        if (condition) {
            testsPassed++;
            System.out.println("[PASS] " + testName);
        } else {
            System.out.println("[FAIL] " + testName);
        }
    }

    // -------------------- Tests --------------------

    private static void testAdjacency() {
        Location a = new SimpleLocation("A");
        Location b = new SimpleLocation("B");

        a.addNeighbor(b);

        check(a.isAdjacent(b), "Adjacency is bidirectional (A -> B)");
        check(b.isAdjacent(a), "Adjacency is bidirectional (B -> A)");
    }

    private static void testIllegalMove() {
        Location trailers = new SimpleLocation("Trailers");
        Location train = new SimpleLocation("Train Station");
        Location jail = new SimpleLocation("Jail");

        trailers.addNeighbor(train);

        Player p = new Player("Blue", 1, 0, 0, trailers);

        boolean threw = false;
        try {
            p.moveTo(jail);
        } catch (Exception e) {
            threw = true;
        }

        check(threw, "Player cannot move to non-adjacent location");
    }

    private static void testMoveWhileWorking() {
        Location trailers = new SimpleLocation("Trailers");
        Location train = new SimpleLocation("Train Station");

        trailers.addNeighbor(train);

        Player p = new Player("Blue", 2, 0, 0, trailers);
        Role role = new SimpleRole("Talking Mule", 1);

        p.takeRole(role);

        boolean threw = false;
        try {
            p.moveTo(train);
        } catch (Exception e) {
            threw = true;
        }

        check(threw, "Player cannot move while working on a role");
    }

    private static void testTakeRoleRankCheck() {
        Location trailers = new SimpleLocation("Trailers");
        Player p = new Player("Blue", 1, 0, 0, trailers);

        Role role = new SimpleRole("High Rank Role", 3);

        boolean threw = false;
        try {
            p.takeRole(role);
        } catch (Exception e) {
            threw = true;
        }

        check(threw, "Player cannot take role above rank");
    }

    private static void testRoleOccupancy() {
        Location trailers = new SimpleLocation("Trailers");

        Player p1 = new Player("Blue", 2, 0, 0, trailers);
        Player p2 = new Player("Red", 2, 0, 0, trailers);

        Role role = new SimpleRole("Talking Mule", 1);

        p1.takeRole(role);

        boolean threw = false;
        try {
            p2.takeRole(role);
        } catch (Exception e) {
            threw = true;
        }

        check(threw, "Role cannot be occupied by two players");
    }

    private static void testRehearse() {
        Location trailers = new SimpleLocation("Trailers");
        Player p = new Player("Blue", 2, 0, 0, trailers);
        Role role = new SimpleRole("Talking Mule", 1);

        p.takeRole(role);
        p.rehearse();
        p.rehearse();

        check(p.getRehearsalChips() == 2, "Rehearsal chips increment correctly");
    }

    private static void testDropRole() {
        Location trailers = new SimpleLocation("Trailers");
        Player p = new Player("Blue", 2, 0, 0, trailers);
        Role role = new SimpleRole("Talking Mule", 1);

        p.takeRole(role);
        p.dropRole();

        check(!p.isWorking(), "Dropping role clears working status");
        check(role.isAvailable(), "Dropping role frees the role");
    }

    private static void testStatusString() {
        Location trailers = new SimpleLocation("Trailers");
        Player p = new Player("Blue", 1, 5, 3, trailers);

        String s = p.statusString();

        check(s.contains("Blue"), "Status shows player name");
        check(s.contains("$5"), "Status shows dollars");
        check(s.contains("3cr"), "Status shows credits");
        check(s.toLowerCase().contains("trailers"), "Status shows location");
    }
}
